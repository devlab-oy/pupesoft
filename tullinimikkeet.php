<?php

require("inc/parametrit.inc");

echo "<font class='head'>".t("Tullinimikkeet")."</font><hr>";

/*
// nämä pitää ajaa jos päivittää uudet tullinimikkeet:
update tullinimike set su=trim(su);
update tullinimike set su='' where su='-';
update tullinimike set su_vientiilmo='NAR' where su='p/st';
update tullinimike set su_vientiilmo='MIL' where su='1 000 p/st';
update tullinimike set su_vientiilmo='MIL' where su='1000 p/st';
update tullinimike set su_vientiilmo='LPA' where su='l alc. 100';
update tullinimike set su_vientiilmo='LTR' where su='l';
update tullinimike set su_vientiilmo='KLT' where su='1 000 l';
update tullinimike set su_vientiilmo='KLT' where su='1000 l';
update tullinimike set su_vientiilmo='TJO' where su='TJ';
update tullinimike set su_vientiilmo='MWH' where su='1 000 kWh';
update tullinimike set su_vientiilmo='MWH' where su='1000 kWh';
update tullinimike set su_vientiilmo='MTQ' where su='m³';
update tullinimike set su_vientiilmo='MTQ' where su='m3';
update tullinimike set su_vientiilmo='GRM' where su='g';
update tullinimike set su_vientiilmo='MTK' where su='m²';
update tullinimike set su_vientiilmo='MTK' where su='m2';
update tullinimike set su_vientiilmo='MTR' where su='m';
update tullinimike set su_vientiilmo='NPR' where su='pa';
update tullinimike set su_vientiilmo='CEN' where su='100 p/st';
update tullinimike set su_vientiilmo='KGE' where su='kg/net eda';
update tullinimike set su_vientiilmo='LPA' where su='l alc. 100%';
update tullinimike set su_vientiilmo='KCC' where su='kg C5H14ClNO';
update tullinimike set su_vientiilmo='MTC' where su='1000 m3';
update tullinimike set su_vientiilmo='KPP' where su='kg P2O5';
update tullinimike set su_vientiilmo='KSH' where su='kg NaOH';
update tullinimike set su_vientiilmo='KPH' where su='kg KOH';
update tullinimike set su_vientiilmo='KUR' where su='kg U';
update tullinimike set su_vientiilmo='GFI' where su='gi F/S';
update tullinimike set su_vientiilmo='KNS' where su='kg H2O2';
update tullinimike set su_vientiilmo='KMA' where su='kg met.am.';
update tullinimike set su_vientiilmo='KNI' where su='kg N';
update tullinimike set su_vientiilmo='KPO' where su='kg K2O';
update tullinimike set su_vientiilmo='KSD' where su='kg 90% sdt';
update tullinimike set su_vientiilmo='CTM' where su='c/k';
update tullinimike set su_vientiilmo='NCL' where su='ce/el';
update tullinimike set su_vientiilmo='CCT' where su='ct/l';
*/

if ($tee == "muuta") {

	$ok = 0;
	$uusitullinimike1 = trim($uusitullinimike1);
	$uusitullinimike2 = trim($uusitullinimike2);

	// katotaan, että tullinimike1 löytyy
	$query = "SELECT cn FROM tullinimike WHERE cn = '$uusitullinimike1' and kieli = '$yhtiorow[kieli]'";
	$result = mysql_query($query) or pupe_error($query);

	if (mysql_num_rows($result) != 1 or $uusitullinimike1 == "") {
		$ok = 1;
		echo "<font class='error'>Tullinimike 1 on virheellinen!</font><br>";
	}

	// kaks pitkä tai ei mitään
	if (strlen($uusitullinimike2) != 2) {
		$ok = 1;
		echo "<font class='error'>Tullinimike 2 tulee olla 2 merkkiä pitkä!</font><br>";
	}

	// tää on aika fiinisliippausta
	if ($ok == 1) echo "<br>";

	// jos kaikki meni ok, nii päivitetään
	if ($ok == 0) {

		if ($tullinimike2 != "") $lisa = " and tullinimike2='$tullinimike2'";
		else $lisa = "";

		$query = "update tuote set tullinimike1='$uusitullinimike1', tullinimike2='$uusitullinimike2' where yhtio='$kukarow[yhtio]' and tullinimike1='$tullinimike1' $lisa";
		$result = mysql_query($query) or pupe_error($query);

		echo sprintf("<font class='message'>Päivitettiin %s tuotetta.</font><br><br>", mysql_affected_rows());

		$tullinimike1 = $uusitullinimike1;
		$tullinimike2 = $uusitullinimike2;
		$uusitullinimike1 = "";
		$uusitullinimike2 = "";
	}
}

if ($tee == "synkronoi") {

	$ok = FALSE;

	if ($file = fopen("http://api.devlab.fi/referenssitullinimikkeet.sql","r")) {
		$ok = TRUE;
	}
	elseif ($file = fopen("http://10.0.1.2/referenssitullinimikkeet.sql","r")) {
		$ok = TRUE;
	}

	if (!$ok) {
		echo t("Tiedoston avaus epäonnistui")."!";
		require ("inc/footer.inc");
		exit;
	}

	echo "<br><br>";
	echo t("Poistetaan vanhat tullinimikkeet")."...<br>";

	// Poistetaan nykyiset nimikkeet....
	$query  = "	DELETE FROM tullinimike";
	$result = mysql_query($query) or pupe_error($query);

	// Päivitetään tuotteet 2011 - 2012
	$muunnosavaimet = array(
		"01011010"=>"01012100",
		"01011090"=>"01013000",
		"01019011"=>"01012910",
		"01019019"=>"01012990",
		"01019030"=>"01013000",
		"01019090"=>"01019000",
		"01021010"=>"01022110",
		"01021030"=>"01022130",
		"01021090"=>"01022190",
		"01029005"=>"01022910",
		"01029021"=>"01022921",
		"01029029"=>"01022929",
		"01029041"=>"01022941",
		"01029049"=>"01022949",
		"01029051"=>"01022951",
		"01029059"=>"01022959",
		"01029061"=>"01022961",
		"01029069"=>"01022969",
		"01029071"=>"01022991",
		"01029079"=>"01022999",
		"01029090"=>"01023990",
		"01051920"=>"01051400",
		"01051990"=>"01051300",
		"01061200"=>"01061200",
		"01061910"=>"01061410",
		"01061990"=>"01061200",
		"01063990"=>"01063300",
		"01069000"=>"01064100",
		"02073211"=>"02074120",
		"02073215"=>"02074130",
		"02073219"=>"02074180",
		"02073251"=>"02075110",
		"02073259"=>"02075190",
		"02073290"=>"02076005",
		"02073311"=>"02074230",
		"02073319"=>"02074280",
		"02073351"=>"02075210",
		"02073359"=>"02075290",
		"02073390"=>"02076005",
		"02073410"=>"02075300",
		"02073490"=>"02074300",
		"02073511"=>"02075410",
		"02073515"=>"02074410",
		"02073521"=>"02074421",
		"02073523"=>"02075421",
		"02073525"=>"02076021",
		"02073531"=>"02074431",
		"02073541"=>"02074441",
		"02073551"=>"02075451",
		"02073553"=>"02074451",
		"02073561"=>"02075461",
		"02073563"=>"02074461",
		"02073571"=>"02074471",
		"02073579"=>"02074481",
		"02073591"=>"02074491",
		"02073599"=>"02074499",
		"02073611"=>"02075510",
		"02073615"=>"02074510",
		"02073621"=>"02074521",
		"02073623"=>"02075521",
		"02073625"=>"02076021",
		"02073631"=>"02074531",
		"02073641"=>"02074541",
		"02073651"=>"02075551",
		"02073653"=>"02074551",
		"02073661"=>"02075561",
		"02073663"=>"02074561",
		"02073671"=>"02074571",
		"02073679"=>"02074581",
		"02073681"=>"02075593",
		"02073685"=>"02074593",
		"02073689"=>"02074595",
		"02073690"=>"02074599",
		"02084090"=>"02084080",
		"02089055"=>"02084020",
		"02089095"=>"02084080",
		"02090011"=>"02091011",
		"02090019"=>"02091019",
		"02090030"=>"02091090",
		"02090090"=>"02099000",
		"02109200"=>"02109210",
		"02109939"=>"02109291",
		"02109960"=>"02109985",
		"02109980"=>"02109292",
		"02109990"=>"02109299",
		"03011010"=>"03011100",
		"03011090"=>"03011900",
		"03019200"=>"03019210",
		"03019300"=>"03019300",
		"03019400"=>"03019410",
		"03019919"=>"03019918",
		"03019980"=>"03019490",
		"03021200"=>"03021300",
		"03022990"=>"03022400",
		"03023510"=>"03023511",
		"03023590"=>"03023519",
		"03023910"=>"03023591",
		"03023990"=>"03023599",
		"03024000"=>"03024100",
		"03025010"=>"03025110",
		"03025090"=>"03025190",
		"03026110"=>"03024310",
		"03026130"=>"03024330",
		"03026180"=>"03024390",
		"03026200"=>"03025200",
		"03026300"=>"03025300",
		"03026400"=>"03024400",
		"03026520"=>"03028110",
		"03026550"=>"03028120",
		"03026560"=>"03028130",
		"03026595"=>"03028190",
		"03026600"=>"03027400",
		"03026700"=>"03024700",
		"03026800"=>"03028300",
		"03026911"=>"03027300",
		"03026915"=>"03027100",
		"03026918"=>"03027200",
		"03026921"=>"03028921",
		"03026925"=>"03028929",
		"03026931"=>"03028931",
		"03026933"=>"03028939",
		"03026935"=>"03025910",
		"03026941"=>"03025920",
		"03026945"=>"03025940",
		"03026951"=>"03025500",
		"03026955"=>"03024200",
		"03026961"=>"03028510",
		"03026966"=>"03025411",
		"03026967"=>"03025415",
		"03026968"=>"03025419",
		"03026969"=>"03025490",
		"03026975"=>"03028940",
		"03026981"=>"03028950",
		"03026982"=>"03025600",
		"03026991"=>"03024510",
		"03026992"=>"03028960",
		"03026994"=>"03028410",
		"03026995"=>"03028530",
		"03026999"=>"03024530",
		"03027000"=>"03029000",
		"03031900"=>"03031200",
		"03032110"=>"03031410",
		"03032120"=>"03031420",
		"03032180"=>"03031490",
		"03032200"=>"03031300",
		"03032900"=>"03031900",
		"03033970"=>"03033400",
		"03034510"=>"03034512",
		"03034590"=>"03034518",
		"03034930"=>"03034591",
		"03034980"=>"03034599",
		"03035210"=>"03036310",
		"03035230"=>"03036330",
		"03035290"=>"03036390",
		"03036100"=>"03035700",
		"03036200"=>"03038300",
		"03037110"=>"03035310",
		"03037130"=>"03035330",
		"03037180"=>"03035390",
		"03037200"=>"03036400",
		"03037300"=>"03036500",
		"03037430"=>"03035410",
		"03037490"=>"03035490",
		"03037520"=>"03038110",
		"03037550"=>"03038120",
		"03037560"=>"03038130",
		"03037595"=>"03038190",
		"03037600"=>"03032600",
		"03037700"=>"03038410",
		"03037811"=>"03036611",
		"03037812"=>"03036612",
		"03037813"=>"03036613",
		"03037819"=>"03036619",
		"03037890"=>"03036690",
		"03037911"=>"03032500",
		"03037919"=>"03032300",
		"03037920"=>"03038921",
		"03037931"=>"03038929",
		"03037935"=>"03038931",
		"03037937"=>"03038939",
		"03037941"=>"03036910",
		"03037945"=>"03036930",
		"03037951"=>"03036980",
		"03037955"=>"03036700",
		"03037958"=>"03038940",
		"03037965"=>"03038945",
		"03037971"=>"03038950",
		"03037975"=>"03038960",
		"03037981"=>"03038965",
		"03037983"=>"03036810",
		"03037985"=>"03036890",
		"03037991"=>"03035510",
		"03037992"=>"03036970",
		"03037993"=>"03038970",
		"03037994"=>"03033950",
		"03037998"=>"03035530",
		"03038010"=>"03039010",
		"03038090"=>"03039090",
		"03041110"=>"03044500",
		"03041190"=>"03045400",
		"03041210"=>"03044600",
		"03041290"=>"03045500",
		"03041901"=>"03043300",
		"03041903"=>"03043200",
		"03041913"=>"03044100",
		"03041915"=>"03044210",
		"03041917"=>"03044290",
		"03041918"=>"03043100",
		"03041931"=>"03044410",
		"03041933"=>"03044430",
		"03041935"=>"03044950",
		"03041939"=>"03044300",
		"03041991"=>"03045100",
		"03041997"=>"03045950",
		"03041999"=>"03045300",
		"03042100"=>"03048400",
		"03042200"=>"03048500",
		"03042901"=>"03046300",
		"03042903"=>"03046200",
		"03042905"=>"03046100",
		"03042913"=>"03048100",
		"03042915"=>"03048210",
		"03042917"=>"03048290",
		"03042918"=>"03046200",
		"03042921"=>"03047110",
		"03042929"=>"03047190",
		"03042931"=>"03047300",
		"03042933"=>"03047200",
		"03042935"=>"03048921",
		"03042939"=>"03048929",
		"03042941"=>"03047930",
		"03042943"=>"03047980",
		"03042945"=>"03048700",
		"03042951"=>"03048941",
		"03042953"=>"03048949",
		"03042955"=>"03047411",
		"03042956"=>"03047415",
		"03042958"=>"03047419",
		"03042959"=>"03047490",
		"03042961"=>"03048951",
		"03042965"=>"03048955",
		"03042968"=>"03048959",
		"03042971"=>"03048310",
		"03042973"=>"03048330",
		"03042975"=>"03048600",
		"03042979"=>"03048350",
		"03042983"=>"03048960",
		"03042985"=>"03047500",
		"03042991"=>"03047950",
		"03042999"=>"03047990",
		"03049910"=>"03049310",
		"03049921"=>"03049390",
		"03049931"=>"03049521",
		"03049933"=>"03049525",
		"03049939"=>"03049529",
		"03049941"=>"03049540",
		"03049945"=>"03049530",
		"03049951"=>"03049550",
		"03049971"=>"03049560",
		"03049975"=>"03049490",
		"03049999"=>"03049590",
		"03053011"=>"03053211",
		"03053019"=>"03053219",
		"03053030"=>"03053910",
		"03053050"=>"03053950",
		"03053090"=>"03053100",
		"03054100"=>"03054100",
		"03054200"=>"03054200",
		"03054910"=>"03054910",
		"03054920"=>"03054920",
		"03054930"=>"03054930",
		"03054945"=>"03054300",
		"03054950"=>"03054410",
		"03054980"=>"03054490",
		"03055110"=>"03055110",
		"03055190"=>"03055190",
		"03055910"=>"03055910",
		"03055930"=>"03055930",
		"03055950"=>"03055950",
		"03055970"=>"03055970",
		"03055980"=>"03055980",
		"03056100"=>"03056100",
		"03056200"=>"03056200",
		"03056300"=>"03056300",
		"03056910"=>"03056910",
		"03056930"=>"03056930",
		"03056950"=>"03056950",
		"03056980"=>"03056400",
		"03061310"=>"03061699",
		"03061330"=>"03061691",
		"03061340"=>"03061791",
		"03061350"=>"03061792",
		"03061380"=>"03061799",
		"03061930"=>"03061590",
		"03062100"=>"03062190",
		"03062310"=>"03062791",
		"03062331"=>"03062631",
		"03062339"=>"03062639",
		"03062390"=>"03062690",
		"03062930"=>"03062590",
		"03071010"=>"03071110",
		"03071090"=>"03071190",
		"03074901"=>"03074909",
		"03076000"=>"03076090",
		"03079100"=>"03077100",
		"03079915"=>"03083050",
		"03079918"=>"03077990",
		"03079990"=>"03077990",
		"04013011"=>"04014010",
		"04013019"=>"04014090",
		"04013031"=>"04015031",
		"04013039"=>"04015039",
		"04013091"=>"04015091",
		"04013099"=>"04015099",
		"04022117"=>"04022118",
		"04022119"=>"04022118",
		"04070011"=>"04071911",
		"04070019"=>"04071100",
		"04070030"=>"04072100",
		"04070090"=>"04071990",
		"06031990"=>"06031500",
		"06041010"=>"06042011",
		"06041090"=>"06042019",
		"06049120"=>"06042020",
		"06049140"=>"06042040",
		"06049190"=>"06042090",
		"06049910"=>"06049091",
		"06049990"=>"06049099",
		"07099010"=>"07099910",
		"07099020"=>"07099920",
		"07099031"=>"07099210",
		"07099039"=>"07099290",
		"07099040"=>"07099940",
		"07099050"=>"07099950",
		"07099060"=>"07099960",
		"07099070"=>"07099310",
		"07099080"=>"07099100",
		"07099090"=>"07099390",
		"07133900"=>"07133400",
		"07139000"=>"07136000",
		"07149011"=>"07143010",
		"07149019"=>"07143090",
		"08011900"=>"08011200",
		"08024000"=>"08024100",
		"08025000"=>"08025100",
		"08026000"=>"08026100",
		"08029020"=>"08027000",
		"08030011"=>"08031010",
		"08030019"=>"08039010",
		"08030090"=>"08031090",
		"08082010"=>"08083010",
		"08082050"=>"08083090",
		"08082090"=>"08084000",
		"08092005"=>"08092100",
		"08092095"=>"08092900",
		"08109050"=>"08103010",
		"08109060"=>"08103030",
		"08109070"=>"08103090",
		"08109095"=>"08107000",
		"08129010"=>"08129025",
		"08129020"=>"08129025",
		"09042010"=>"09042110",
		"09042030"=>"09042190",
		"09042090"=>"09042200",
		"09050000"=>"09051000",
		"09070000"=>"09071000",
		"09081000"=>"09081100",
		"09082000"=>"09082100",
		"09083000"=>"09083100",
		"09091000"=>"09096100",
		"09092000"=>"09092100",
		"09093000"=>"09093100",
		"09094000"=>"09096100",
		"09095000"=>"09096100",
		"09101000"=>"09101100",
		"10011000"=>"10011100",
		"10019010"=>"10019110",
		"10019091"=>"10019120",
		"10019099"=>"10019190",
		"10020000"=>"10021000",
		"10030010"=>"10031000",
		"10030090"=>"10039000",
		"10040000"=>"10041000",
		"10051011"=>"10051018",
		"10051019"=>"10051018",
		"10070010"=>"10071010",
		"10070090"=>"10071090",
		"10082000"=>"10082100",
		"10089010"=>"10086000",
		"10089090"=>"10084000",
		"11021000"=>"11029070",
		"11031910"=>"11031920",
		"11031930"=>"11031920",
		"11032010"=>"11032025",
		"11032020"=>"11032025",
		"11042220"=>"11042240",
		"11042230"=>"11042240",
		"11042290"=>"11042295",
		"11042298"=>"11042295",
		"11042310"=>"11042340",
		"11042330"=>"11042340",
		"11042390"=>"11042398",
		"11042399"=>"11042398",
		"11042901"=>"11042904",
		"11042903"=>"11042904",
		"11042907"=>"11042908",
		"11042909"=>"11042908",
		"11042911"=>"11042917",
		"11042918"=>"11042917",
		"12010010"=>"12011000",
		"12010090"=>"12019000",
		"12021010"=>"12023000",
		"12021090"=>"12024100",
		"12022000"=>"12023000",
		"12072010"=>"12072100",
		"12072090"=>"12072900",
		"12079915"=>"12071000",
		"12079997"=>"12071000",
		"12092910"=>"12092945",
		"12092935"=>"12092945",
		"12099110"=>"12099180",
		"12099190"=>"12099180",
		"12122000"=>"12122100",
		"12129920"=>"12129300",
		"12129930"=>"12129200",
		"12129970"=>"12129400",
		"15010011"=>"15011010",
		"15010019"=>"15011090",
		"15010090"=>"15019000",
		"15020010"=>"15021010",
		"15020090"=>"15021090",
		"16023130"=>"16023180",
		"16023190"=>"16023180",
		"16023940"=>"16023985",
		"16023980"=>"16023985",
		"16029072"=>"16029091",
		"16029074"=>"16029095",
		"16029076"=>"16029091",
		"16029078"=>"16029095",
		"16041998"=>"16041700",
		"16043010"=>"16043100",
		"16043090"=>"16043200",
		"16051000"=>"03061405",
		"16052010"=>"03061610",
		"16052091"=>"03061610",
		"16052099"=>"03061610",
		"16053090"=>"03061205",
		"16054000"=>"03061105",
		"16059011"=>"03073905",
		"16059019"=>"03073905",
		"16059030"=>"03071910",
		"16059090"=>"03081910",
		"17011110"=>"17011310",
		"17011190"=>"17011390",
		"20019060"=>"20019092",
		"20019091"=>"20019092",
		"20032000"=>"20039010",
		"20039000"=>"20039090",
		"20059940"=>"20059980",
		"20059990"=>"20059980",
		"20085094"=>"20085098",
		"20085099"=>"20085098",
		"20089212"=>"20089712",
		"20089214"=>"20089714",
		"20089216"=>"20089716",
		"20089218"=>"20089718",
		"20089232"=>"20089732",
		"20089234"=>"20089734",
		"20089236"=>"20089736",
		"20089238"=>"20089738",
		"20089251"=>"20089751",
		"20089259"=>"20089759",
		"20089272"=>"20089772",
		"20089274"=>"20089774",
		"20089276"=>"20089776",
		"20089278"=>"20089778",
		"20089292"=>"20089792",
		"20089293"=>"20089793",
		"20089294"=>"20089794",
		"20089296"=>"20089796",
		"20089297"=>"20089797",
		"20089298"=>"20089798",
		"20089928"=>"20089311",
		"20089934"=>"20089319",
		"20089937"=>"20089321",
		"20089940"=>"20089329",
		"20089949"=>"20089391",
		"20089967"=>"20089393",
		"20089999"=>"20089399",
		"20094110"=>"20094192",
		"20094191"=>"20094192",
		"20097993"=>"20097998",
		"20097999"=>"20097998",
		"20098011"=>"20098911",
		"20098019"=>"20098919",
		"20098034"=>"20098934",
		"20098035"=>"20098111",
		"20098036"=>"20098936",
		"20098038"=>"20098119",
		"20098050"=>"20098950",
		"20098061"=>"20098961",
		"20098063"=>"20098963",
		"20098069"=>"20098969",
		"20098071"=>"20098971",
		"20098073"=>"20098973",
		"20098079"=>"20098131",
		"20098085"=>"20098985",
		"20098086"=>"20098151",
		"20098088"=>"20098988",
		"20098089"=>"20098159",
		"20098095"=>"20098195",
		"20098096"=>"20098996",
		"20098097"=>"20098997",
		"20098099"=>"20098199",
		"22089052"=>"22089056",
		"22089056"=>"22089056",
		"23099095"=>"23099096",
		"23099099"=>"23099096",
		"24031010"=>"24031100",
		"24031090"=>"24031100",
		"25281000"=>"25280000",
		"25289000"=>"25280000",
		"27011110"=>"27011100",
		"27011190"=>"27011100",
		"27079930"=>"27079920",
		"27079970"=>"27079920",
		"27101111"=>"27101211",
		"27101115"=>"27101215",
		"27101121"=>"27101221",
		"27101125"=>"27101225",
		"27101131"=>"27101231",
		"27101141"=>"27101241",
		"27101145"=>"27101245",
		"27101149"=>"27101249",
		"27101151"=>"27101251",
		"27101159"=>"27101259",
		"27101170"=>"27101270",
		"27101190"=>"27101290",
		"27101941"=>"27101943",
		"27101945"=>"27101947",
		"27101949"=>"27101948",
		"27101961"=>"27101962",
		"27101963"=>"27101968",
		"27101965"=>"27101968",
		"27101969"=>"27101968",
		"27101981"=>"27101981",
		"27101983"=>"27101983",
		"27101985"=>"27101985",
		"27101987"=>"27101987",
		"27101991"=>"27101991",
		"27101993"=>"27101993",
		"27101999"=>"27101999",
		"28070010"=>"28070000",
		"28070090"=>"28070000",
		"28249010"=>"28249000",
		"28249090"=>"28249000",
		"28309085"=>"28309085",
		"28353900"=>"28353900",
		"28399010"=>"28399000",
		"28399090"=>"28399000",
		"28421000"=>"28421000",
		"28480000"=>"28480000",
		"28499090"=>"28499090",
		"28500020"=>"28500020",
		"28500060"=>"28500060",
		"28500090"=>"28500090",
		"28520000"=>"28521000",
		"29034100"=>"29037710",
		"29034200"=>"29037720",
		"29034300"=>"29037730",
		"29034410"=>"29037740",
		"29034490"=>"29037750",
		"29034510"=>"29037790",
		"29034515"=>"29037790",
		"29034520"=>"29037790",
		"29034525"=>"29037790",
		"29034530"=>"29037790",
		"29034535"=>"29037790",
		"29034540"=>"29037790",
		"29034545"=>"29037790",
		"29034550"=>"29037790",
		"29034555"=>"29037790",
		"29034590"=>"29037790",
		"29034610"=>"29037610",
		"29034620"=>"29037620",
		"29034690"=>"29037690",
		"29034700"=>"29037800",
		"29034911"=>"29037100",
		"29034915"=>"29037300",
		"29034919"=>"29037200",
		"29034920"=>"29037919",
		"29034930"=>"29037921",
		"29034940"=>"29037929",
		"29034980"=>"29037990",
		"29035100"=>"29038100",
		"29035200"=>"29038200",
		"29035920"=>"29038910",
		"29035980"=>"29038990",
		"29036100"=>"29039100",
		"29036200"=>"29039200",
		"29036910"=>"29039910",
		"29036990"=>"29039990",
		"29089910"=>"29089900",
		"29089990"=>"29089200",
		"29121910"=>"29121900",
		"29121990"=>"29121900",
		"29123000"=>"29124900",
		"29124900"=>"29124900",
		"29142100"=>"29142900",
		"29142900"=>"29142900",
		"29157000"=>"29157040",
		"29159000"=>"29159030",
		"29161950"=>"29161600",
		"29163500"=>"29163910",
		"29163900"=>"29163990",
		"29173410"=>"29173400",
		"29173490"=>"29173400",
		"29252900"=>"29252900",
		"29310010"=>"29319010",
		"29310020"=>"29319020",
		"29310030"=>"29319030",
		"29310040"=>"29319040",
		"29310099"=>"29311000",
		"29322100"=>"29322090",
		"29322910"=>"29322010",
		"29322920"=>"29322010",
		"29322930"=>"29322010",
		"29322940"=>"29322010",
		"29322950"=>"29322010",
		"29322960"=>"29322020",
		"29322985"=>"29322090",
		"29332990"=>"29332990",
		"29349990"=>"28529000",
		"29373100"=>"29379000",
		"29373900"=>"29379000",
		"29374000"=>"29379000",
		"29379000"=>"29379000",
		"29394900"=>"29394400",
		"30021010"=>"30021010",
		"30021091"=>"30021091",
		"30021095"=>"30021095",
		"30021099"=>"30021099",
		"30022000"=>"30021010",
		"30029090"=>"30021010",
		"30049000"=>"30049000",
		"30066010"=>"30066000",
		"30066090"=>"30066000",
		"31052000"=>"31052010",
		"32019090"=>"28529000",
		"32064930"=>"32064970",
		"32064980"=>"32064970",
		"35019090"=>"28529000",
		"35029020"=>"28529000",
		"35029070"=>"28529000",
		"35029090"=>"28529000",
		"35040010"=>"28529000",
		"35040090"=>"28529000",
		"37023120"=>"37023197",
		"37023198"=>"37023197",
		"37025100"=>"37025200",
		"37025200"=>"37025200",
		"37029120"=>"37029610",
		"37029180"=>"37029690",
		"37029310"=>"37029610",
		"37029390"=>"37029690",
		"37029410"=>"37029710",
		"37029490"=>"37029790",
		"37029500"=>"37029800",
		"37061010"=>"37061020",
		"37061091"=>"37061020",
		"37069010"=>"37069052",
		"37069031"=>"37069052",
		"37069051"=>"37069052",
		"38085000"=>"38085000",
		"38089110"=>"38085000",
		"38089120"=>"38085000",
		"38089130"=>"38085000",
		"38089140"=>"38085000",
		"38089190"=>"38085000",
		"38089210"=>"38085000",
		"38089220"=>"38085000",
		"38089230"=>"38085000",
		"38089240"=>"38085000",
		"38089250"=>"38085000",
		"38089260"=>"38085000",
		"38089290"=>"38085000",
		"38089311"=>"38085000",
		"38089313"=>"38085000",
		"38089315"=>"38085000",
		"38089317"=>"38085000",
		"38089321"=>"38085000",
		"38089323"=>"38085000",
		"38089327"=>"38085000",
		"38089330"=>"38085000",
		"38089390"=>"38085000",
		"38089410"=>"38085000",
		"38089420"=>"38085000",
		"38089490"=>"38085000",
		"38089910"=>"38085000",
		"38089990"=>"38085000",
		"38249091"=>"38260010",
		"38249097"=>"28529000",
		"39072099"=>"30021010",
		"39262000"=>"39262000",
		"39269097"=>"39269097",
		"41012090"=>"41012080",
		"41019000"=>"41019000",
		"41039090"=>"41039000",
		"41051010"=>"41051000",
		"41051090"=>"41051000",
		"41053091"=>"41053090",
		"41053099"=>"41053090",
		"41062110"=>"41062100",
		"41062190"=>"41062100",
		"43018030"=>"43018000",
		"43018050"=>"43018000",
		"43018070"=>"43018000",
		"43021910"=>"43021915",
		"43021920"=>"43021915",
		"43021930"=>"43021915",
		"43021950"=>"43021999",
		"43021960"=>"43021999",
		"43021970"=>"43021999",
		"43021995"=>"43021999",
		"43023021"=>"43023099",
		"43023031"=>"43023099",
		"43023041"=>"43023099",
		"43023045"=>"43023099",
		"43023061"=>"43023099",
		"43023071"=>"43023099",
		"43023095"=>"43023099",
		"44013020"=>"44013100",
		"44013040"=>"44013910",
		"44013080"=>"44013990",
		"44072961"=>"44072960",
		"44072968"=>"44072960",
		"44079920"=>"44079927",
		"44079925"=>"44079927",
		"44081093"=>"44081098",
		"44081099"=>"44081098",
		"44083931"=>"44083930",
		"44083935"=>"44083930",
		"48053010"=>"48053000",
		"48053090"=>"48053000",
		"48082000"=>"48084000",
		"48083000"=>"48084000",
		"48099010"=>"48099000",
		"48099090"=>"48099000",
		"48101320"=>"48101300",
		"48101380"=>"48101300",
		"48101420"=>"48101400",
		"48101480"=>"48101400",
		"48101910"=>"48101900",
		"48101990"=>"48101900",
		"48102210"=>"48102200",
		"48102290"=>"48102200",
		"48109930"=>"48109980",
		"48109990"=>"48109980",
		"48141000"=>"48149070",
		"48149080"=>"48149070",
		"48184011"=>"96190011",
		"48184013"=>"96190013",
		"48184019"=>"96190019",
		"48184091"=>"96190021",
		"48184099"=>"96190029",
		"56011010"=>"96190031",
		"56011090"=>"96190039",
		"58012400"=>"58012700",
		"58012500"=>"58012700",
		"58013400"=>"58013700",
		"58013500"=>"58013700",
		"61082100"=>"61082100",
		"61082200"=>"61082200",
		"61082900"=>"61082900",
		"61112090"=>"61112090",
		"61113090"=>"61113090",
		"61119090"=>"61119090",
		"61130010"=>"61130010",
		"61130090"=>"61130090",
		"62089100"=>"62089100",
		"62089200"=>"62089200",
		"62089900"=>"62089900",
		"62092000"=>"62092000",
		"62093000"=>"62093000",
		"62099090"=>"62099090",
		"62101090"=>"62101092",
		"62105000"=>"62105000",
		"62114100"=>"62114900",
		"62114900"=>"62114900",
		"63069100"=>"63069000",
		"63069900"=>"63069000",
		"63079010"=>"63079010",
		"63079099"=>"63079092",
		"64069100"=>"64069090",
		"64069930"=>"64069030",
		"64069950"=>"64069050",
		"64069960"=>"64069060",
		"64069985"=>"64069090",
		"65051000"=>"65050090",
		"65059005"=>"65050010",
		"65059010"=>"65050090",
		"65059030"=>"65050030",
		"65059080"=>"65050090",
		"68030000"=>"68030010",
		"68118300"=>"68118900",
		"68118900"=>"68118900",
		"70193100"=>"70193110",
		"70193200"=>"70193210",
		"70199010"=>"70199000",
		"70199030"=>"70199000",
		"70199091"=>"70199000",
		"70199099"=>"70199000",
		"73021021"=>"73021022",
		"73021023"=>"73021022",
		"73021029"=>"73021028",
		"73072930"=>"73072980",
		"73072990"=>"73072980",
		"73079930"=>"73079980",
		"73079990"=>"73079980",
		"73084010"=>"73084000",
		"73084090"=>"73084000",
		"73089010"=>"73089098",
		"73089099"=>"73089098",
		"73144110"=>"73144100",
		"73144190"=>"73144100",
		"73144210"=>"73144200",
		"73144290"=>"73144200",
		"73158210"=>"73158200",
		"73158290"=>"73158200",
		"73170010"=>"73170080",
		"73170040"=>"73170060",
		"73170061"=>"73170060",
		"73170069"=>"73170060",
		"73170090"=>"73170080",
		"73192000"=>"73194000",
		"73193000"=>"73194000",
		"73218110"=>"73218100",
		"73218190"=>"73218100",
		"73218210"=>"73218200",
		"73218290"=>"73218200",
		"73239310"=>"73239300",
		"73239390"=>"73239300",
		"73239410"=>"73239400",
		"73239490"=>"73239400",
		"73239910"=>"73239900",
		"73239991"=>"73239900",
		"73239999"=>"73239900",
		"73262030"=>"73262000",
		"73262050"=>"73262000",
		"73262080"=>"73262000",
		"73269010"=>"73269092",
		"73269070"=>"73269092",
		"73269091"=>"73269092",
		"73269093"=>"73269094",
		"73269095"=>"73269096",
		"73269098"=>"73269098",
		"74181100"=>"74181090",
		"74181910"=>"74181010",
		"74181990"=>"74181090",
		"76151100"=>"76151090",
		"76151910"=>"76151010",
		"76151990"=>"76151090",
		"82012000"=>"82019000",
		"82019000"=>"82019000",
		"82058000"=>"82059010",
		"82059000"=>"82059090",
		"82077035"=>"82077037",
		"82077038"=>"82077037",
		"84399110"=>"84399100",
		"84399190"=>"84399100",
		"84399910"=>"84399900",
		"84399990"=>"84399900",
		"84433110"=>"84433180",
		"84433191"=>"84433120",
		"84433199"=>"84433180",
		"84453010"=>"84453000",
		"84453090"=>"84453000",
		"84513010"=>"84513000",
		"84513030"=>"84513000",
		"84513080"=>"84513000",
		"84523010"=>"84523000",
		"84523090"=>"84523000",
		"84524000"=>"84529000",
		"84529000"=>"84529000",
		"84569000"=>"84569080",
		"84669300"=>"84669370",
		"84672910"=>"84672920",
		"84672930"=>"84672920",
		"84672990"=>"84672985",
		"84798997"=>"84569020",
		"84799020"=>"84669330",
		"84799080"=>"84669330",
		"84879010"=>"84879040",
		"84879030"=>"84879040",
		"84879053"=>"84879057",
		"84879055"=>"84879057",
		"85078020"=>"85075000",
		"85078030"=>"85076000",
		"85078080"=>"85078000",
		"85234011"=>"85234110",
		"85234013"=>"85234130",
		"85234019"=>"85234190",
		"85234025"=>"85234925",
		"85234031"=>"85234931",
		"85234039"=>"85234939",
		"85234045"=>"85234945",
		"85234051"=>"85234951",
		"85234059"=>"85234959",
		"85234091"=>"85234991",
		"85234093"=>"85234993",
		"85234099"=>"85234999",
		"85287113"=>"85287115",
		"85287190"=>"85287191",
		"85404000"=>"85404000",
		"85405000"=>"85404000",
		"85407200"=>"85407900",
		"85407900"=>"85407900",
		"87059010"=>"87059080",
		"87059090"=>"87059080",
		"87112091"=>"87112092",
		"87112093"=>"87112092",
		"87119000"=>"87119010",
		"87120010"=>"87120070",
		"87120080"=>"87120070",
		"87141100"=>"87141000",
		"87141900"=>"87141000",
		"87149310"=>"87149300",
		"87149390"=>"87149300",
		"87149410"=>"87149420",
		"87149430"=>"87149420",
		"87161010"=>"87161092",
		"87161091"=>"87161092",
		"87161094"=>"87161092",
		"87161096"=>"87161098",
		"87161099"=>"87161098",
		"87163951"=>"87163950",
		"87163959"=>"87163950",
		"90071100"=>"90071000",
		"90071900"=>"90071000",
		"90081000"=>"90085000",
		"90082000"=>"90085000",
		"90083000"=>"90085000",
		"90084000"=>"90085000",
		"91091100"=>"91091000",
		"91091900"=>"91091000",
		"91142000"=>"91149000",
		"91149000"=>"91149000",
		"93011100"=>"93011000",
		"93011900"=>"93011000",
		"93052100"=>"93052000",
		"93052900"=>"93052000",
		"95041000"=>"95045000",
		"95049090"=>"95045000",
		"96083100"=>"96083000",
		"96083910"=>"96083000",
		"96083990"=>"96083000",
		"96086010"=>"96086000",
		"96086090"=>"96086000");

	echo t("Päivitetään muuttuneet tullinimikkeet tuotteille")."...<br>";

	foreach ($muunnosavaimet as $vanha => $uusi) {
		$query  = "	UPDATE tuote set
					tullinimike1 = '$uusi'
					where yhtio			= '$kukarow[yhtio]'
					and tullinimike1	= '$vanha'";
		$result = mysql_query($query) or pupe_error($query);
	}

	// Eka rivi roskikseen
	$rivi = fgets($file);

	echo t("Lisätään uudet tullinimikkeet tietokantaan")."...<br>";

	while ($rivi = fgets($file)) {
		list($cnkey, $cn, $dashes, $dm, $su, $su_vientiilmo, $kieli) = explode("\t", trim($rivi));

		$dm = preg_replace("/([^A-Z0-9öäåÅÄÖ \.,\-_\:\/\!\|\?\+\(\)%#]|é)/i", "", $dm);

		$query  = "	INSERT INTO tullinimike SET
					yhtio			= '$kukarow[yhtio]',
					cnkey			= '$cnkey',
					cn				= '$cn',
					dashes			= '$dashes',
					dm				= '$dm',
					su				= '$su',
					su_vientiilmo	= '$su_vientiilmo',
					kieli			= '$kieli',
					laatija			= '$kukarow[kuka]',
					luontiaika		= now()";
		$result = mysql_query($query) or pupe_error($query);
	}

	fclose($file);

	echo t("Päivitys valmis")."...<br><br><hr>";
}


echo "<br><form action = '$PHP_SELF' method='post' autocomplete='off'>";
echo t("Listaa ja muokkaa tuotteiden tullinimikkeitä").":<br><br>";
echo "<table>";
echo "<tr>";
echo "<th>".t("Syötä tullinimike").":</th>";
echo "<td><input type='text' name='tullinimike1' value='$tullinimike1'></td>";
echo "</tr><tr>";
echo "<th>".t("Syötä tullinimikkeen lisäosa").":</th>";
echo "<td><input type='text' name='tullinimike2' value='$tullinimike2'> (ei pakollinen) </td>";
echo "<td class='back'><input type='submit' value='".t("Hae")."'></td>";
echo "</tr></table>";
echo "</form><br><br>";

echo "<form action = '$PHP_SELF' method='post' autocomplete='off'>";
echo "<input type='hidden' name='tee' value='synkronoi'>";
echo t("Päivitä järjestelmän tullinimiketietokanta").":<br><br>";
echo "<table>";
echo "<th>".t("Nouda uusimmat tullinimikkeet").":</th>";
echo "<td><input type='submit' value='".t("Nouda")."'></td>";
echo "</tr></table>";
echo "</form>";


if ($tullinimike1 != "") {

	if ($tullinimike2 != "") $lisa = " and tullinimike2='$tullinimike2'";
	else $lisa = "";

	$query = "	SELECT *
				from tuote use index (yhtio_tullinimike)
				where yhtio = '$kukarow[yhtio]'
				and tullinimike1 = '$tullinimike1' $lisa
				order by tuoteno";
	$resul = mysql_query($query) or pupe_error($query);

	if (mysql_num_rows($resul) == 0) {
		echo "<font class='error'>Yhtään tuotetta ei löytynyt!</font><br>";
	}
	else {

		echo sprintf("<font class='message'>Haulla löytyi %s tuotetta.</font><br><br>", mysql_num_rows($resul));

		echo "<form action = '$PHP_SELF' method='post' autocomplete='off'>";
		echo "<input type='hidden' name='tullinimike1' value='$tullinimike1'>";
		echo "<input type='hidden' name='tullinimike2' value='$tullinimike2'>";
		echo "<input type='hidden' name='tee' value='muuta'>";

		echo "<table>";
		echo "<tr>";
		echo "<th>".t("Syötä uusi tullinimike").":</th>";
		echo "<td><input type='text' name='uusitullinimike1' value='$uusitullinimike1'></td>";
		echo "</tr><tr>";
		echo "<th>".t("Syötä tullinimikkeen lisäosa").":</th>";
		echo "<td><input type='text' name='uusitullinimike2' value='$uusitullinimike2'></td>";
		echo "<td class='back'><input type='submit' value='".t("Päivitä")."'></td>";
		echo "</tr></table>";
		echo "</form><br>";

		echo "<table>";
		echo "<tr>";
		echo "<th>".t("Tuoteno")."</th>";
		echo "<th>".t("Osasto")."</th>";
		echo "<th>".t("Try")."</th>";
		echo "<th>".t("Merkki")."</th>";
		echo "<th>".t("Nimitys")."</th>";
		echo "<th>".t("Tullinimike")."</th>";
		echo "<th>".t("Tullinimikkeen lisäosa")."</th>";
		echo "</tr>";

		while ($rivi = mysql_fetch_array($resul)) {

			// tehdään avainsana query
			$oresult = t_avainsana("OSASTO", "", "and avainsana.selite ='$rivi[osasto]'");
			$os = mysql_fetch_array($oresult);

			// tehdään avainsana query
			$tresult = t_avainsana("TRY", "", "and avainsana.selite ='$rivi[try]'");
			$try = mysql_fetch_array($tresult);

			echo "<tr>";
			echo "<td><a href='yllapito.php?toim=tuote&tunnus=$rivi[tunnus]&lopetus=tullinimikkeet.php'>$rivi[tuoteno]</a></td>";
			echo "<td>$rivi[osasto] $os[selitetark]</td>";
			echo "<td>$rivi[try] $try[selitetark]</td>";
			echo "<td>$rivi[tuotemerkki]</td>";
			echo "<td>".t_tuotteen_avainsanat($rivi, 'nimitys')."</td>";
			echo "<td>$rivi[tullinimike1]</td>";
			echo "<td>$rivi[tullinimike2]</td>";
			echo "</tr>";
		}
		echo "</table>";
	}
}

require ("inc/footer.inc");

?>